# Локальная отладка сервера

## Цель

Проверить, что сервер работает локально перед деплоем на Verpex.

## Шаг 1: Установить зависимости

```bash
cd commerce
npm install
```

## Шаг 2: Собрать проект

```bash
npm run build
```

Это создаст папку `.next` с собранным проектом.

## Шаг 3: Запустить сервер локально

### Вариант 1: Использовать server.js (основной)

```bash
node server.js
```

Сервер запустится на `http://localhost:3001`

### Вариант 2: Использовать server-safe.js (с диагностикой)

```bash
node server-safe.js
```

Сервер запустится на `http://localhost:3001` и покажет диагностику.

### Вариант 3: Использовать server-error-catcher.js (для отладки)

```bash
node server-error-catcher.js
```

## Шаг 4: Проверить работу

1. Откройте `http://localhost:3001` в браузере
2. Проверьте, что сайт открывается
3. Проверьте консоль на наличие ошибок

## Шаг 5: Проверить handler

Если используется `server-safe.js` или `server-error-catcher.js`:
1. Дождитесь, пока `prepare()` завершится
2. Обновите страницу
3. Проверьте, работает ли handler

## Что проверить

- ✅ Сервер запускается без ошибок
- ✅ Next.js загружается
- ✅ `prepare()` завершается успешно
- ✅ Handler обрабатывает запросы
- ✅ Сайт открывается и работает

## Если есть ошибки

1. Проверьте консоль на ошибки
2. Проверьте, что все зависимости установлены
3. Проверьте, что `.next` папка создана после `npm run build`
4. Проверьте версию Node.js (должна быть 18+)

## После успешной локальной проверки

Если всё работает локально, значит проблема в конфигурации Verpex или ограничениях shared hosting.













